<?phpnamespace WPEssential\Plugins\OrderExportWoo\Utility;if ( ! defined( 'ABSPATH' ) ) {	exit; // Exit if accessed directly.}class WooOrderExport{	public static function constructor ()	{		add_action( 'admin_menu', [ __CLASS__, 'woe_add_page_link' ] );	}	public static function woe_add_page_link ()	{		$page = add_submenu_page(			'woocommerce',			esc_html__( 'WPEOEW Export', 'wpessential-order-export-woo' ),			esc_html__( 'WPEOEW Export', 'wpessential-order-export-woo' ),			'edit_posts',			WPE_AJAX_PREFIX . '_wpeow',			[ __CLASS__, 'form' ]		);		add_action( "admin_print_scripts-$page", [ __CLASS__, 'scripts' ] );	}	public static function form ()	{		?>		<div class="container">			<form method="post" class="wpeoew_form">				<h1><?php echo esc_html( 'WPEssential Order Export Woo' ); ?></h1>				<div class="row">					<div class="col-25">						<label for="fdate"><?php esc_html_e( 'Start Date', 'wpessential-order-export-woo' ) ?>:</label>					</div>					<div class="col-75">						<input type="text" id="form_date" name="from_date" required placeholder="MM/DD/YY">					</div>				</div>				<div class="row">					<div class="col-25">						<label for="tdate"><?php esc_html_e( 'End Date', 'wpessential-order-export-woo' ) ?>:</label>					</div>					<div class="col-75">						<input type="text" id="to_date" name="to_date" required placeholder="MM/DD/YY">					</div>				</div>				<div class="row">					<div class="col-25">						<label for="order_status"><?php esc_html_e( 'Order Status', 'wpessential-order-export-woo' ) ?>:</label>					</div>					<div class="col-75">						<select name="order_status">							<?php							$status = wc_get_order_statuses();							foreach ( $status as $sk => $sv ) {								?>								<option value="<?php echo $sk; ?>"><?php esc_html_e( $sv, 'wpessential-order-export-woo' ); ?></option>;							<?php } ?>						</select>					</div>				</div>				<div class="row">					<div class="col-25">						<label for="post_order"><?php esc_html_e( 'Post Order', 'wpessential-order-export-woo' ) ?>:</label>					</div>					<div class="col-75">						<select name="order">							<option value="DESC" selected="selected"><?php esc_html_e( 'Descending', 'wpessential-order-export-woo' ) ?></option>							<option value="ASC"><?php esc_html_e( 'Ascending', 'wpessential-order-export-woo' ) ?></option>						</select>					</div>				</div>				<div class="row">					<div class="col-25">						<label for="post_order_by"><?php esc_html_e( 'Post Order By', 'wpessential-order-export-woo' ) ?>:</label>					</div>					<div class="col-75">						<select name="orderby">							<option value="none" selected="selected"><?php esc_html_e( 'None', 'wpessential-order-export-woo' ) ?></option>							<option value="ID"><?php esc_html_e( 'IDs', 'wpessential-order-export-woo' ) ?></option>							<option value="name"><?php esc_html_e( 'Name', 'wpessential-order-export-woo' ) ?></option>							<option value="type"><?php esc_html_e( 'Type', 'wpessential-order-export-woo' ) ?></option>							<option value="rand"><?php esc_html_e( 'Random', 'wpessential-order-export-woo' ) ?></option>							<option value="date"><?php esc_html_e( 'Date', 'wpessential-order-export-woo' ) ?></option>							<option value="modified"><?php esc_html_e( 'Modified', 'wpessential-order-export-woo' ) ?></option>						</select>					</div>				</div>				<div class="row">					<div class="col-25">						<label for="custom_address"><?php esc_html_e( 'Customer Email', 'wpessential-order-export-woo' ) ?>:</label>					</div>					<div class="col-75">						<input type="email" id="custom_address" name="custom_address" placeholder="admin@example.com">					</div>				</div>				<div class="row">					<?php wp_nonce_field( WPE_NONCE, 'nonce' ); ?>					<input type="submit" value="<?php esc_attr_e( 'Export Orders', 'wpessential-order-export-woo' ); ?>">				</div>			</form>		</div>		<?php	}	public static function scripts ()	{		wp_enqueue_style( 'jquery-ui-datepicker-css', WPEOEW_URL . 'assets/css/jquery-ui.min.css', '', WPEOEW_VERSION, 'all' );		wp_enqueue_style( 'wpessential-order-export-woo', WPEOEW_URL . 'assets/css/wpessential-order-export-woo.css', '', WPEOEW_VERSION, 'all' );		$script = 'jQuery(document).ready(function($){			$("#form_date, #to_date").datepicker();			$(".order_export_form").submit(function(e){				e.preventDefault();				var form_data = "action=wpe_woeow_file_download&" + $(this).serialize();				$.ajax({url:"' . admin_url( 'admin-ajax.php' ) . '",type: "POST",data: form_data,success: function(res){if(res != 0){window.open(res);}else{alert("' . esc_js( 'Data Not Exist.' ) . '");}}});			});		})';		wp_enqueue_script( 'jquery-ui-datepicker' );		wp_add_inline_script( 'jquery-ui-datepicker', $script );	}}